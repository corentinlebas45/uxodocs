"use strict";(globalThis.webpackChunkuxodocs=globalThis.webpackChunkuxodocs||[]).push([[1751],{571:(e,t,o)=>{o.d(t,{A:()=>n});const n=o.p+"assets/images/photo-cover-46d00ae668a5fc6d131d4f89000810b6.avif"},2068:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>s,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"cookbooks/js-sort-documents","title":"Sort documents in a punnet","description":"photo cover","source":"@site/docs/fast2/cookbooks/js-sort-documents.md","sourceDirName":"cookbooks","slug":"/cookbooks/js-sort-documents","permalink":"/uxodocs/docs/fast2/cookbooks/js-sort-documents","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"worker","permalink":"/uxodocs/docs/fast2/tags/worker"},{"inline":true,"label":"json","permalink":"/uxodocs/docs/fast2/tags/json"},{"inline":true,"label":"javascript","permalink":"/uxodocs/docs/fast2/tags/javascript"},{"inline":true,"label":"document","permalink":"/uxodocs/docs/fast2/tags/document"},{"inline":true,"label":"nashorn","permalink":"/uxodocs/docs/fast2/tags/nashorn"}],"version":"current","frontMatter":{"title":"Sort documents in a punnet","date":"2023-01-12","author":"Joseph TESSIER","tags":["worker","json","javascript","document","nashorn"],"photograph":"H\xe9ctor J. Rivas","photograph_pseudo":"@@hjrc33"},"sidebar":"docs","previous":{"title":"JDBC : How to link Fast2 and SQL DB","permalink":"/uxodocs/docs/fast2/cookbooks/jdbc-for-sql"},"next":{"title":"Learn how to deal with punnets","permalink":"/uxodocs/docs/fast2/cookbooks/punnet_basics"}}');var a=o(4848),r=o(8453);const s={title:"Sort documents in a punnet",date:"2023-01-12",author:"Joseph TESSIER",tags:["worker","json","javascript","document","nashorn"],photograph:"H\xe9ctor J. Rivas",photograph_pseudo:"@@hjrc33"},i=void 0,c={},d=[{value:"\ud83e\uddd0 Where do we come from ?",id:"-where-do-we-come-from-",level:2},{value:"\ud83e\udd14 Where to go ?",id:"-where-to-go-",level:2},{value:"\ud83d\ude80 Way to go !",id:"-way-to-go-",level:2},{value:"\u2697\ufe0f JavaScript elaboration",id:"\ufe0f-javascript-elaboration",level:3},{value:"\ud83c\udfc1 Result",id:"-result",level:3},{value:"\ud83d\udc4f Let&#39;s sum up",id:"-lets-sum-up",level:2}];function l(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"photo cover",src:o(571).A+"",width:"870",height:"580"})}),"\n",(0,a.jsxs)(t.p,{children:["As we have seen before in the ",(0,a.jsx)(t.a,{href:"/uxodocs/docs/fast2/getting-started/overall-concepts#punnet",children:"punnet structure"}),", punnets can be composed with several different documents, each one of them embedding its own data and values."]}),"\n",(0,a.jsx)(t.p,{children:"Whether it be for the purpose of processing order of these documents or any other operation requiring these same documents to be sorted in a different order, the catalog provides sufficient tooling to tackle this challenge."}),"\n",(0,a.jsxs)(t.p,{children:["For the matter, we will consider having to sort the documents based on a ",(0,a.jsx)(t.code,{children:"Date"}),' data, which will go by the name of "creation_date".']}),"\n",(0,a.jsx)(t.h2,{id:"-where-do-we-come-from-",children:"\ud83e\uddd0 Where do we come from ?"}),"\n",(0,a.jsxs)(t.p,{children:["For the educational aspect of this topic, let us consider a punnet gathering several documents, all with the same data : ",(0,a.jsx)(t.code,{children:"creation_date"}),", currently ",(0,a.jsx)(t.code,{children:"String"}),"-typed."]}),"\n",(0,a.jsx)(t.p,{children:"Our punnet would look like this:"}),"\n",(0,a.jsx)("figure",{markdown:!0,children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-txt",children:"\u251c\u2500 Punnet\n\u2502     \u251c\u2500 document_1\n\u2502     \u2502       \u2514\u2500 dataset\n\u2502     \u2502             \u251c\u2500 creation_date=03/3/2020 3:03:03 PM\n\u2502     \u2502             \u2514\u2500 ...\n\u2502     \u251c\u2500 document_2\n\u2502     \u2502       \u2514\u2500 dataset\n\u2502     \u2502             \u251c\u2500 creation_date=01/1/2020 1:01:01 PM\n\u2502     \u2502             \u2514\u2500 ...\n\u2502     \u251c\u2500 document_3\n\u2502     \u2502       \u2514\u2500 dataset\n\u2502     \u2502             \u251c\u2500 creation_date=02/2/2020 2:02:02 PM\n\u2502     \u2502             \u2514\u2500 ...\n\u2502     \u2514\u2500 ...\n\u2514\u2500 ...\n"})})}),"\n",(0,a.jsxs)(t.p,{children:["As we can see, the correct order should be ",(0,a.jsx)(t.strong,{children:"document_2"}),", then ",(0,a.jsx)(t.strong,{children:"document_3"})," and finally ",(0,a.jsx)(t.strong,{children:"document_1"}),"."]}),"\n",(0,a.jsx)(t.h2,{id:"-where-to-go-",children:"\ud83e\udd14 Where to go ?"}),"\n",(0,a.jsx)(t.p,{children:"At a glance, we are just couple steps away from sorting our documents : we need to go over all documents, dig into their dataset and retrieve the value of the sorting criteria."}),"\n",(0,a.jsx)(t.p,{children:"However we need to go through a String-to-Date conversion so the sorting will be done correctly over datetimes values, instead of alphabetical values."}),"\n",(0,a.jsx)(t.p,{children:"!!! Check"}),"\n",(0,a.jsx)(t.p,{children:"We will just reorganise all the documents within the punnet, they will be considered like tiles to rearrange, but we need not to mix their own data up (for obvious data integrity reasons)."}),"\n",(0,a.jsx)(t.h2,{id:"-way-to-go-",children:"\ud83d\ude80 Way to go !"}),"\n",(0,a.jsx)(t.p,{children:"The JSTransform task will be our hobbyhorse here since it offers the ability to handle the punnet at a pretty low cost in terms of performance and setup."}),"\n",(0,a.jsx)(t.h3,{id:"\ufe0f-javascript-elaboration",children:"\u2697\ufe0f JavaScript elaboration"}),"\n",(0,a.jsx)(t.p,{children:"You will need to add a new JSTransform task right after any task in your workflow have the punnet with all the documents (ex/ a ContentExtractor with all versions of a document extracted)."}),"\n",(0,a.jsx)(t.p,{children:"This JavaScript-ish task will be configured with the following script :"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-js",children:'// Java types required for Java objects\nvar SimpleDateFormat = Java.type("java.text.SimpleDateFormat");\nvar Document = Java.type("com.fast2.model.punnet.Document");\nvar Collections = Java.type("java.util.Collections");\n\n// Global parameters\nvar dataToSort = "creation_date";\nvar dateFormat = "MM/d/yyyy h:mm:ss aa";\n\nvar formatter = new SimpleDateFormat(dateFormat);\n\nvar compareByDate = function (doc1, doc2) {\n  try {\n    return formatter\n      .parse(doc1.getDataSet().getDataValue(dataToSort))\n      .compareTo(formatter.parse(doc2.getDataSet().getDataValue(dataToSort)));\n  } catch (e) {}\n  return 0;\n};\n\nCollections.sort(punnet.getDocuments(), compareByDate);\n'})}),"\n",(0,a.jsx)(t.p,{children:"Explanations :"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["L7 : the data which you want to sort, in our case the ",(0,a.jsx)(t.code,{children:"creation_date"})]}),"\n",(0,a.jsxs)(t.li,{children:["L8 : the date format we deduced from the ",(0,a.jsx)(t.code,{children:"String"})," value of the previous data"]}),"\n",(0,a.jsxs)(t.li,{children:["L12-L17 : we need to parse the value as date, to compare the date as so instead of regular ",(0,a.jsx)(t.code,{children:"String"})," values (which could be too approximative) ",(0,a.jsx)("br",{})]}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"The output of this task will be the same documents in the punnet, just ordered by creation date ascending."}),"\n",(0,a.jsx)("br",{}),"\n",(0,a.jsx)(t.p,{children:"Head out now to the Run screen, and start your campaign."}),"\n",(0,a.jsx)(t.h3,{id:"-result",children:"\ud83c\udfc1 Result"}),"\n",(0,a.jsx)(t.p,{children:"At the latest stage of your workflow, the document dataset is filled with the properties found in the JSON and integrated as metadata."}),"\n",(0,a.jsx)("figure",{markdown:!0,children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-txt",children:"\u251c\u2500 Punnet\n\u2502     \u251c\u2500 document_2\n\u2502     \u2502       \u2514\u2500 dataset\n\u2502     \u2502             \u251c\u2500 creation_date=01/1/2020 1:01:01 PM\n\u2502     \u2502             \u2514\u2500 ...\n\u2502     \u251c\u2500 document_3\n\u2502     \u2502       \u2514\u2500 dataset\n\u2502     \u2502             \u251c\u2500 creation_date=02/2/2020 2:02:02 PM\n\u2502     \u2502             \u2514\u2500 ...\n\u2502     \u251c\u2500 document_4\n\u2502     \u2502       \u2514\u2500 dataset\n\u2502     \u2502             \u251c\u2500 creation_date=03/3/2020 3:03:03 PM\n\u2502     \u2502             \u2514\u2500 ...\n\u2502     \u2514\u2500 ...\n\u2514\u2500 ...\n"})})}),"\n",(0,a.jsx)(t.h2,{id:"-lets-sum-up",children:"\ud83d\udc4f Let's sum up"}),"\n",(0,a.jsxs)(t.p,{children:["We can bring this scenario further by sorting based on 2 or more data, regular ",(0,a.jsx)(t.code,{children:"int"})," values or else."]}),"\n",(0,a.jsx)(t.p,{children:"Since its just sorting, you might want to sort the documents in the reverse order. In this example, we left the default behavior (ascending), but a minor tweak to the previous script and you'll be good to go !"}),"\n",(0,a.jsx)(t.p,{children:"If this use-case echoes your early needs, other tasks can be tied to this map to reach a higher level of complexity characteristic of real-world migration projects."})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},8453:(e,t,o)=>{o.d(t,{R:()=>s,x:()=>i});var n=o(6540);const a={},r=n.createContext(a);function s(e){const t=n.useContext(r);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);