"use strict";(globalThis.webpackChunkuxodocs=globalThis.webpackChunkuxodocs||[]).push([[9271],{484:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>r,contentTitle:()=>i,default:()=>h,frontMatter:()=>c,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"cookbooks/content-metadata-from-s3","title":"Retrieve content and metadata from an S3 bucket","description":"Blog cover","source":"@site/docs/fast2/cookbooks/content-metadata-from-s3.md","sourceDirName":"cookbooks","slug":"/cookbooks/content-metadata-from-s3","permalink":"/uxodocs/docs/fast2/cookbooks/content-metadata-from-s3","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"xml","permalink":"/uxodocs/docs/fast2/tags/xml"},{"inline":true,"label":"pattern","permalink":"/uxodocs/docs/fast2/tags/pattern"},{"inline":true,"label":"document","permalink":"/uxodocs/docs/fast2/tags/document"},{"inline":true,"label":"AWS S3","permalink":"/uxodocs/docs/fast2/tags/aws-s-3"},{"inline":true,"label":"content","permalink":"/uxodocs/docs/fast2/tags/content"}],"version":"current","frontMatter":{"title":"Retrieve content and metadata from an S3 bucket","tags":["xml","pattern","document","AWS S3","content"]},"sidebar":"docs","previous":{"title":"Fast2 cookbooks","permalink":"/uxodocs/docs/fast2/cookbooks/"},"next":{"title":"Contents in Fast2","permalink":"/uxodocs/docs/fast2/cookbooks/content_basics"}}');var a=n(4848),s=n(8453);const c={title:"Retrieve content and metadata from an S3 bucket",tags:["xml","pattern","document","AWS S3","content"]},i=void 0,r={},d=[{value:"\ud83e\uddd0 Where do we come from ?",id:"-where-do-we-come-from-",level:2},{value:"\ud83e\udd14 Where to go ?",id:"-where-to-go-",level:2},{value:"\ud83d\ude80 Way to go !",id:"-way-to-go-",level:2},{value:"\ud83d\udd0e Find content from metadata",id:"-find-content-from-metadata",level:3},{value:"\ud83d\udc4f Let&#39;s wrap up",id:"-lets-wrap-up",level:2}];function l(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Blog cover",src:n(5071).A+"",width:"2221",height:"1250"})}),"\n",(0,a.jsx)(t.p,{children:"Extracting metadata from a S3 bucket needs to be done differently than what could be done with a regular content management system, because it is a storage space and not an ECM."}),"\n",(0,a.jsxs)(t.p,{children:['!!! warning "Prior to v2.10, Fast2 needed a few steps to add \u201cmanually\u201d (with ',(0,a.jsx)(t.a,{href:"/uxodocs/docs/fast2/catalog/transformer#AlterDocumentProperties",children:"AlterDocumentProperties"}),') key and bucket information in the XML file, to then get corresponding PDF files."']}),"\n",(0,a.jsx)(t.p,{children:"Extracting metadata from a S3 bucket needs to be done differently than what could be done with a regular content management system, where a document is a set of contents and metadata. Indeed, S3 bucket is a storage space and not an ECM (we\u2019ll get into that a little bit later)."}),"\n",(0,a.jsx)(t.p,{children:"Let\u2019s quickly review here how extracting both content and metadata in a S3 bucket can be achieved with Fast2."}),"\n",(0,a.jsx)(t.h2,{id:"-where-do-we-come-from-",children:"\ud83e\uddd0 Where do we come from ?"}),"\n",(0,a.jsx)(t.p,{children:"For this case, let's supposed our documents have been injected in S3 bucket (direct sequel of the Upload content and metadata in a S3 bucket cookbook). This action splits them into pairs of individual files : contents (PDF) and matching metadata (XML) files, each sharing the same file name."}),"\n",(0,a.jsx)("figure",{markdown:!0,children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-txt",children:"\u251c\u2500 Bucket S3/\n\u2502       \u251c\u2500 folder A\n\u2502       \u2502     \u251c\u2500 document_A_1.xml\n\u2502       \u2502     \u251c\u2500 document_A_1.pdf\n\u2502       \u2502     \u2514\u2500 ...\n\u2502       \u2502\n\u2502       \u251c\u2500 folder B\n\u2502       \u2502     \u251c\u2500 document_B_1.xml\n\u2502       \u2502     \u251c\u2500 document_B_1.pdf\n\u2502       \u2502     \u2514\u2500 ...\n\u2502       \u2514\u2500...\n\u2514\u2500 ...  \n"})})}),"\n",(0,a.jsx)(t.p,{children:"Another constraint is that the PDF path information has been set into the XML file during the serialisation prior to the injection. So, once stored in the S3 bucket, it is not up-to-date."}),"\n",(0,a.jsx)(t.h2,{id:"-where-to-go-",children:"\ud83e\udd14 Where to go ?"}),"\n",(0,a.jsx)(t.p,{children:"We want to end up with a regular Fast2 document composed with a content (PDF) and its metadata (parsed from the matching XML). Because of the old content path information (explained earlier), the content (PDF) will not be found in the XML information, inducing an incomplete document to be created."}),"\n",(0,a.jsx)(t.h2,{id:"-way-to-go-",children:"\ud83d\ude80 Way to go !"}),"\n",(0,a.jsx)(t.p,{children:"First, we identify XML files. They contain all metadata, namely the PDF content we need to attach."}),"\n",(0,a.jsx)(t.p,{children:"Then, we update the file extension : PDF and corresponding XML files have the same name."}),"\n",(0,a.jsx)(t.p,{children:"And finally, thanks to the source information, and XML metadata, we resolve the matching PDF content path, extract it from the bucket, and tie it to the Fast2 document."}),"\n",(0,a.jsx)(t.h3,{id:"-find-content-from-metadata",children:"\ud83d\udd0e Find content from metadata"}),"\n",(0,a.jsxs)(t.p,{children:["In the ",(0,a.jsx)(t.a,{href:"/uxodocs/docs/fast2/catalog/source#AWSSource",children:"AWSSource"})," task , we extract only interested XML files because they contain metadata :"]}),"\n",(0,a.jsxs)(t.p,{children:["To only select punnet-formated XML correponding to the punnets, you will need to fill the AWS suffix field with : ",(0,a.jsx)(t.code,{children:"xml"}),"."]}),"\n",(0,a.jsx)(t.p,{children:"Optionally, you can also provide the concerned folder(s) in the Source folders if relevant."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"AWSContentSource task configuration",src:n(6206).A+"",width:"326",height:"902"})}),"\n",(0,a.jsxs)(t.p,{children:["In the ",(0,a.jsx)(t.a,{href:"/uxodocs/docs/fast2/catalog/contentsource#AWSContentSource",children:"AWSContentSource"})," task configuration, fields to fill are :"]}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["Bucket name : ",(0,a.jsx)(t.code,{children:"${bucket}"})]}),"\n",(0,a.jsx)(t.li,{children:"Content path (S3 object key) :"}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-java",children:"${s3_key.substring(0, s3_key.lastIndexOf(\u201c/\u201d)) + \u201d/\u201d + docName}\n"})}),"\n",(0,a.jsx)(t.p,{children:"By filling the S3 objecy key, the connector will on-the-fly build up the correct path where to look for the related content, and tie it to the punnet."}),"\n",(0,a.jsx)(t.p,{children:"Fast2 extracts all metadata files present in our S3 bucket, following the key of the XML, as a punnet, and names them correctly."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"AWSSource task configuration",src:n(2878).A+"",width:"772",height:"616"})}),"\n",(0,a.jsx)(t.h2,{id:"-lets-wrap-up",children:"\ud83d\udc4f Let's wrap up"}),"\n",(0,a.jsx)(t.p,{children:"We updated path information into XML files, which contain the XML-structured punnet. Then, we can attached corresponding PDF files."}),"\n",(0,a.jsx)(t.p,{children:"We have now punnets containing linked content and metadata, which were sharing the same name in the bucket."}),"\n",(0,a.jsx)(t.p,{children:"Next, we could process them through additional conversion or data transformation steps, or inject them into a secondary repository, you name it."})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},2878:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/Image_AWSContentSource2025-22900daae814051165ceb38ebfa518f8.png"},5071:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/content-metadata-from-s3_cover-84a623f047d70d1fcc8d4f83925f59b9.png"},6206:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/Image_AWS_Source2025-309dd0ca59b71b3d2a0537a4230d27ac.png"},8453:(e,t,n)=>{n.d(t,{R:()=>c,x:()=>i});var o=n(6540);const a={},s=o.createContext(a);function c(e){const t=o.useContext(s);return o.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:c(e.components),o.createElement(s.Provider,{value:t},e.children)}}}]);