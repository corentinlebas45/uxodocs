<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-fast2 docs-version-current docs-doc-page docs-doc-id-components/database" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">Internal database | UXO Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://corentinlebas45.github.io/uxodocs/docs/fast2/components/database"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-fast2-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-fast2-current"><meta data-rh="true" property="og:title" content="Internal database | UXO Docs"><meta data-rh="true" name="description" content="Prior to the v2.5, Fast2 was relying on an Elasticsearch database. This component has been dropped in favor of OpenSearch."><meta data-rh="true" property="og:description" content="Prior to the v2.5, Fast2 was relying on an Elasticsearch database. This component has been dropped in favor of OpenSearch."><link data-rh="true" rel="icon" href="/uxodocs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://corentinlebas45.github.io/uxodocs/docs/fast2/components/database"><link data-rh="true" rel="alternate" href="https://corentinlebas45.github.io/uxodocs/docs/fast2/components/database" hreflang="en"><link data-rh="true" rel="alternate" href="https://corentinlebas45.github.io/uxodocs/docs/fast2/components/database" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Components","item":"https://corentinlebas45.github.io/uxodocs/docs/fast2/components/"},{"@type":"ListItem","position":2,"name":"Internal database","item":"https://corentinlebas45.github.io/uxodocs/docs/fast2/components/database"}]}</script><link rel="stylesheet" href="/uxodocs/assets/css/styles.c0027a3a.css">
<script src="/uxodocs/assets/js/runtime~main.f0861c75.js" defer="defer"></script>
<script src="/uxodocs/assets/js/main.623fe0b4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/uxodocs/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/uxodocs/"><div class="navbar__logo"><img src="/uxodocs/img/logo.svg" alt="UXO" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/uxodocs/img/logo.svg" alt="UXO" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">UXO Docs</b></a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current="page" class="navbar__link verdd verdd--fast2 active" aria-haspopup="true" aria-expanded="false" role="button" href="/uxodocs/docs/fast2/components/database">current</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/uxodocs/docs/fast2/components/database">current</a></li><li><a class="dropdown__link" href="/uxodocs/docs/fast2/v2/fast2">v2</a></li><li><a class="dropdown__link" href="/uxodocs/docs/fast2/v1/fast2">v1</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link verdd verdd--arender" aria-haspopup="true" aria-expanded="false" role="button" href="/uxodocs/docs/arender">current</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/uxodocs/docs/arender">current</a></li><li><a class="dropdown__link" href="/uxodocs/docs/arender/v2/arender">v2</a></li><li><a class="dropdown__link" href="/uxodocs/docs/arender/v1/arender">v1</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link verdd verdd--flowerdocs" aria-haspopup="true" aria-expanded="false" role="button" href="/uxodocs/docs/flowerdocs">current</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/uxodocs/docs/flowerdocs">current</a></li><li><a class="dropdown__link" href="/uxodocs/docs/flowerdocs/v2/flowerdocs">v2</a></li><li><a class="dropdown__link" href="/uxodocs/docs/flowerdocs/v1/flowerdocs">v1</a></li></ul></div></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/corentinlebas45/uxodocs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/uxodocs/docs/fast2/getting-started"><span title="Getting Started" class="categoryLinkLabel_W154">Getting Started</span></a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/uxodocs/docs/fast2/advanced"><span title="Advanced" class="categoryLinkLabel_W154">Advanced</span></a><button aria-label="Expand sidebar category &#x27;Advanced&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/uxodocs/docs/fast2/API"><span title="API documentation" class="linkLabel_WmDU">API documentation</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/uxodocs/docs/fast2/catalog"><span title="Catalog" class="categoryLinkLabel_W154">Catalog</span></a><button aria-label="Expand sidebar category &#x27;Catalog&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/uxodocs/docs/fast2/components"><span title="Components" class="categoryLinkLabel_W154">Components</span></a><button aria-label="Collapse sidebar category &#x27;Components&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/uxodocs/docs/fast2/components/broker"><span title="The broker" class="linkLabel_WmDU">The broker</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/uxodocs/docs/fast2/components/dashboards"><span title="Dashboards" class="linkLabel_WmDU">Dashboards</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/uxodocs/docs/fast2/components/database"><span title="Internal database" class="linkLabel_WmDU">Internal database</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/uxodocs/docs/fast2/components/worker"><span title="The worker" class="linkLabel_WmDU">The worker</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/uxodocs/docs/fast2/cookbooks"><span title="Fast2 cookbooks" class="categoryLinkLabel_W154">Fast2 cookbooks</span></a><button aria-label="Expand sidebar category &#x27;Fast2 cookbooks&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/uxodocs/docs/fast2"><span title="Fast2" class="linkLabel_WmDU">Fast2</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/uxodocs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/uxodocs/docs/fast2/components"><span>Components</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Internal database</span></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: current</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Internal database</h1></header>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>Prior to the v2.5, Fast2 was relying on an Elasticsearch database. This component has been dropped in favor of OpenSearch.</p><p>However the configuration of these two databases are very close (if not identical).</p></div></div>
<p>Every object passing through Fast2 is stored into an internal database. Whether carried by the document or the punnet, all metadata are recorded in the warehouse. The major benefit of such architecture is the opportunity to check whether everything is going well by making counters about documents/data processed during your migrations.</p>
<p>In addition, we can easily rollback or resume operations in case of server crash. Nothing will be lost as Fast2 will precisely know where it all stopped.</p>
<p>There is the logic behind real-time backups in ES.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="octicons-list-unordered-24-indexes">:octicons-list-unordered-24: Indexes<a href="#octicons-list-unordered-24-indexes" class="hash-link" aria-label="Direct link to :octicons-list-unordered-24: Indexes" title="Direct link to :octicons-list-unordered-24: Indexes" translate="no">​</a></h2>
<p>Each database index referenced by Fast2 will be registered with a <code>f2_</code> prefix. An index is always written in lower case even if the campaign name in Fast2 contains characters in upper cases.</p>
<p>For example, the campaign <code>MyCampaign_Try10</code> will be stored in the index f2_mycampaign_try15.</p>
<p>During the step of broker intantiation at Fast2 startup, some indices are automatically created:</p>
<table><thead><tr><th style="text-align:right">Index key</th><th>Description</th></tr></thead><tbody><tr><td style="text-align:right">f2_campaigns</td><td>List of existing campaigns with processing dates and status</td></tr><tr><td style="text-align:right">f2_campaigns_sources</td><td>Links between campaigns and workers having performed this campaign</td></tr><tr><td style="text-align:right">f2_queue_settings</td><td>Reference information about source and task threads</td></tr><tr><td style="text-align:right">f2_jobs_settings</td><td>Gather the configuration of save jobs</td></tr><tr><td style="text-align:right">f2_jobs_info</td><td>Information about jobs past execution details</td></tr></tbody></table>
<p>For each new campaign of Fast2, an index will be created: if you decided to run a new campaign named <code>EcmInjection</code>, the new index will be <code>f2_ecminjection_try1</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="material-database-cog-configuration">:material-database-cog: Configuration<a href="#material-database-cog-configuration" class="hash-link" aria-label="Direct link to :material-database-cog: Configuration" title="Direct link to :material-database-cog: Configuration" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="with-or-without">With or without<a href="#with-or-without" class="hash-link" aria-label="Direct link to With or without" title="Direct link to With or without" translate="no">​</a></h3>
<p>For an optimal migration setup, this third-party software can be easily configured at different levels to match you needs at most !
If required, it can even be disabled at will.</p>
<p>=== &quot;v2.4-&quot;</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">./config/applications.properties</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">broker.elasticsearch.embedded.enabled=true</span><br></span></code></pre></div></div>
<p>=== &quot;v2.5+&quot;</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">./config/applications.properties</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">broker.opensearch.embedded.enabled=true</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="port">Port<a href="#port" class="hash-link" aria-label="Direct link to Port" title="Direct link to Port" translate="no">​</a></h3>
<p>By default, Fast2 sends it data via the embedded database API made available on port <code>1790</code>.</p>
<p>However, in the case where this port is already used by either another Fast2 instance or any other process, the port number can be changed from the configuration files.</p>
<p>Since the embedded database has to be reach from both Fast2 broker and Kibana module — if the latter is enabled — there is exactly 3 places where to mention this change:</p>
<p>=== &quot;v2.4-&quot;</p>
<table><thead><tr><th>File</th><th>Specification</th></tr></thead><tbody><tr><td>./config/application.properties</td><td><code>opensearch.port=1790</code></td></tr><tr><td>./elasticsearch-X.Y.Z/config/elasticsearch.yml</td><td><code>http.port: &lt;es-port&gt;</code></td></tr><tr><td>./kibana-X.Y.Z/config/kibana.yml</td><td><code>elasticsearch.hosts: [&quot;http://localhost:&lt;es-port&gt;&quot;]</code></td></tr></tbody></table>
<p>=== &quot;v2.5+&quot;</p>
<table><thead><tr><th>File</th><th>Specification</th></tr></thead><tbody><tr><td>./config/application.properties</td><td><code>opensearch.port=1790</code></td></tr><tr><td>./opensearch-X.Y.Z/config/opensearch.yml</td><td><code>http.port: &lt;es-port&gt;</code></td></tr><tr><td>./opensearch-dashboards-X.Y.Z/config/opensearch_dashboards.yml</td><td><code>opensearch.hosts: [&quot;http://localhost:&lt;es-port&gt;&quot;]</code></td></tr></tbody></table>
<p>If the dashboard component is installed, the database port also needs to be updated on this front as the dashboard needs to access the DB in order to read the data :</p>
<p>=== &quot;v2.4-&quot;</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">./kibana-X.Y.Z/config/kibana.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">elasticsearch.hosts: [&quot;http://&lt;DB-server:DB-port&gt;&quot;]</span><br></span></code></pre></div></div>
<p>=== &quot;v2.6+&quot;</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">./opensearch-dashboards-X.Y.Z/config/opensearch_dashboards.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">opensearch.hosts: [&quot;http://&lt;DB-server:DB-port&gt;&quot;]</span><br></span></code></pre></div></div>
<br>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="memory">Memory<a href="#memory" class="hash-link" aria-label="Direct link to Memory" title="Direct link to Memory" translate="no">​</a></h3>
<p>The more documents, the more data. The more data, the more the database will need resources to digest, store, process data and respond to the broker.</p>
<p>Head out to the <code>./opensearch-X.Y.Z/config/jvm.options</code> file.</p>
<p>The configuration required are the following:</p>
<table><thead><tr><th style="text-align:right">Configuration</th><th style="text-align:left">Purpose</th></tr></thead><tbody><tr><td style="text-align:right"><code>-Xms8g</code></td><td style="text-align:left">This setting will allocate 8GB of RAM to the database JVM heap, directly on startup.</td></tr><tr><td style="text-align:right"><code>-Xmx8g</code></td><td style="text-align:left">Here, you specify the maximum memory which can be used, if available, by the database.</td></tr></tbody></table>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>As specified in the <code>./opensearch-X.Y.Z/config/jvm.options</code> file, you should always set the min and max JVM heap size to <strong>the same value</strong>. <br><br>See the <a href="https://opensearch.org/docs/opensearch/install/important-settings/" target="_blank" rel="noopener noreferrer">Official OpenSearch documentation</a> for more information.</p></div></div>
<p>For further comprehension of these parameters, check out the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/important-settings.html#heap-size-settings" target="_blank" rel="noopener noreferrer">Elasticsearch official documentation</a> on the topic or <a href="https://opensearch.org/docs/1.1/opensearch/install/important-settings/" target="_blank" rel="noopener noreferrer">OpenSearch official documenation</a>.
Upgrading the metrics will prevent <code>java.lang.OutOfMemoryError</code> to pop up during heavy migration executions.</p>
<br>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="remote-access-to-the-database">Remote access to the database<a href="#remote-access-to-the-database" class="hash-link" aria-label="Direct link to Remote access to the database" title="Direct link to Remote access to the database" translate="no">​</a></h2>
<p>The next operations need to happen when the database is shut down. To make sure of that, the <code>jcmd</code> command might be of great help.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>The database port needs to be opened from the Fast2 server, and accessible by your remote machine.</p></div></div>
<ol>
<li>
<p>To check the database port is accessible from your machine, run the following command (from your work station):</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl &lt;fast2.server&gt;:&lt;database-port&gt;</span><br></span></code></pre></div></div>
</li>
<li>
<p>Head out to the database configuration YAML file <code>opensearch.yml</code> and add the following lines:</p>
<div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">network.host</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">node.name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> node</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">cluster.initial_master_nodes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> node</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><br></span></code></pre></div></div>
</li>
<li>
<p>If Fast2 is installed on a Linux server, you may also need to increase the memory usage for your cluster (on the server where the database is running), as stipulated in the <a href="https://opensearch.org/docs/1.0/opensearch/install/important-settings/" target="_blank" rel="noopener noreferrer">Official OpenSearch documentation</a>.</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">/etc/sysctl.conf</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># for remote access to Fast2 embedded database</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vm.max_map_count=262144</span><br></span></code></pre></div></div>
</li>
<li>
<p>Save the file, and run the following command to <em>refresh</em> your server configuration :</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo sysctl -p</span><br></span></code></pre></div></div>
</li>
<li>
<p>Restart the broker (which will induce the bootup of the database), and go check from your machine the access to the Fast2 database.</p>
<p>The webpage (at the same URL we <code>curl</code>-ed in the 1st step) should display something like so :</p>
<p><img decoding="async" loading="lazy" alt="Webpage of remote access to the database" src="/uxodocs/assets/images/db_remote_access_webpage-5fb5434cf3a402f6430068c934ba75b9.png" width="896" height="559" class="img_ev3q"></p>
</li>
</ol>
<br>
<br>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting" translate="no">​</a></h2>
<p>In reason of the tight commmunication between the broker and the database, chances are you will soon be reported 500 server error generated by unsuccessful exchanges of the two entities.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="server-error-500-when-starting-a-campaign">Server error 500 when starting a campaign<a href="#server-error-500-when-starting-a-campaign" class="hash-link" aria-label="Direct link to Server error 500 when starting a campaign" title="Direct link to Server error 500 when starting a campaign" translate="no">​</a></h3>
<p>After running quite a bunch of campaigns, you might end up not being able to start anymore of them due to the limit of shards of the embedded database (for more in-depth details about the shards, checkout the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/scalability.html" target="_blank" rel="noopener noreferrer">Official Elasticsearch documentation</a>).</p>
<p>The symptom of this limitations comes as a regular 500 server error toast in the UI, but is is by checking the logs/broker.log file that its raw nature is exposed:</p>
<div class="language-log codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-log codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">17:24:45.017 [http-nio-1789-exec-17] ERROR org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/]:175 - Exception while dispatching incoming RPC call com.google.gwt.user.server.rpc.UnexpectedException: Service method &#x27;public abstract com.fast2.model.taskflow.Campaign com.fast2.hmi.gwt.client.service.GWTCampaignManager.startProcessing(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    com.fast2.model.taskflow.Campaign,com.fast2.model.taskflow.design.TaskFlowMapRef,boolean)&#x27; threw an unexpected exception:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    java.lang.RuntimeException: Caught exception OpenSearch exception [type=validation_exception, reason=Validation Failed: 1: this action would add [2] total shards, but this cluster currently has [1000]/[1000] maximum shards open;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Caused by: org.opensearch.OpenSearchStatusException: OpenSearch exception [type=validation_exception, reason=Validation Failed: 1: this action would add [2] total shards, but this cluster currently has [1000]/[1000] maximum shards open;]</span><br></span></code></pre></div></div>
<p>As mentioned in the <a href="#index-names">database technicalities</a>, Fast2 records data under indices prefixed with <code>f2_</code>. Thus it implies to begin each index to delete with this prefix.</p>
<p>Although a drastic cleanup induced by a <code>curl -X DELETE -i &quot;http://&lt;database-server&gt;:&lt;database-port&gt;/f2_*</code> would resolve our issue, you might be interested in keeping some campaigns or indices. As any <em>curl</em> query allows, exceptions can be added to the deletion operation to prevent them from being removed of the backup database. The syntax goes as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -X DELETE -i &quot;http://&lt;Fast2-server&gt;:&lt;database-port&gt;/f2_*,-f2_campaigns,-f2_campaigns_sources[,-f2_&lt;campaign-name&gt;]&quot;</span><br></span></code></pre></div></div>
<br>
<br>
<p>Let us now study this query:</p>
<br>
<br>
<table><thead><tr><th>Section</th><th>Purpose</th></tr></thead><tbody><tr><td><code>http://server:port/f2_*</code></td><td>Here we ask to aim at all indices starting with the <code>f2_</code> prefix. This will prevent the deletion of additional indices which could be related to parallel work on the same database instance, such as Kibana reports, charts or data analysis.</td></tr><tr><td><code>-f2_campaigns,-f2_campaigns_sources</code></td><td>These 2 indices are needed if you decide to keep any other campaign. The <code>-</code> sign declares them as exception from the delete action.</td></tr><tr><td><code>[,-f2_&lt;campaign-name&gt;]</code></td><td>Then you can list all the campaigns you are willing to preserve, <ul><li>without space,</li><li>separated by commas (<code>,</code>)</li><li>mentioning the <code>-</code> exclusion character</li></ul>Do not forget to begin each name with the indice prefix.</td></tr></tbody></table>
<br>
<p>Wildcards are supported, therefore an exception written <code>-f2_mycampaign*</code> will protect all the campaign with this <em>myCampaign</em> radical (ex/ myCampaign_Try1, myCampaign_Try2...).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="impossible-to-get-results-from-explorer-place">Impossible to get results from Explorer place<a href="#impossible-to-get-results-from-explorer-place" class="hash-link" aria-label="Direct link to Impossible to get results from Explorer place" title="Direct link to Impossible to get results from Explorer place" translate="no">​</a></h3>
<p>Documents concerned by a migration can quickly add up, especially on cumulative campaigns. When heading to the Explorer to check punnets results, you may end up with too much information to retrieve from the database. An &quot;error 500&quot; message will then pop up, and if yu head out to the broker.log, the following stack will be found:</p>
<div class="language-log codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-log codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Suppressed: org.opensearch.client.ResponseException: method [POST], host [http://localhost:1790], URI [/f2_campaign_try1/_search?pre_filter_shard_size=...], status line [HTTP/1.1 503 Service Unavailable]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;error&quot;:{&quot;root_cause&quot;:[{&quot;type&quot;:&quot;too_many_buckets_exception&quot;,&quot;reason&quot;:&quot;Trying to create too many buckets. Must be less than or equal to: [10000] but was [10001]. This limit can be set by changing the [search.max_buckets] cluster level setting.&quot;,&quot;max_buckets&quot;:10000}],&quot;type&quot;:&quot;search_phase_execution_exception&quot;,&quot;reason&quot;:&quot;all shards failed&quot;,&quot;phase&quot;:&quot;query&quot;,&quot;grouped&quot;:true,&quot;failed_shards&quot;:[{&quot;shard&quot;:0,&quot;index&quot;:&quot;f2_stg-100k_try1&quot;,&quot;node&quot;:&quot;4XM6VD2wTfeOSpr2brIs7g&quot;,&quot;reason&quot;:{&quot;type&quot;:&quot;too_many_buckets_exception&quot;,&quot;reason&quot;:&quot;Trying to create too many buckets. Must be less than or equal to: [10000] but was [10001]. This limit can be set by changing the [search.max_buckets] cluster level setting.&quot;,&quot;max_buckets&quot;:10000}}]},&quot;status&quot;:503}</span><br></span></code></pre></div></div>
<p>To fix this, you need to stop Fast2 (and the database), and add the following line:</p>
<div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">./opensearch-X.Y.Z/config/opensearch.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">search.max_buckets</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000000</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="lets-quickly-wrap-up-here">Let&#x27;s quickly wrap up, here<a href="#lets-quickly-wrap-up-here" class="hash-link" aria-label="Direct link to Let&#x27;s quickly wrap up, here" title="Direct link to Let&#x27;s quickly wrap up, here" translate="no">​</a></h2>
<p>This integrated database guarantees data persistence to Fast2. If required, an embedded database can be shared among several Fast2 servers.</p>
<br>
<p>Allocated resources should be increased in order to resist charge of production environments.</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/uxodocs/docs/fast2/components/dashboards"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Dashboards</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/uxodocs/docs/fast2/components/worker"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">The worker</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#octicons-list-unordered-24-indexes" class="table-of-contents__link toc-highlight">:octicons-list-unordered-24: Indexes</a></li><li><a href="#material-database-cog-configuration" class="table-of-contents__link toc-highlight">:material-database-cog: Configuration</a><ul><li><a href="#with-or-without" class="table-of-contents__link toc-highlight">With or without</a></li><li><a href="#port" class="table-of-contents__link toc-highlight">Port</a></li><li><a href="#memory" class="table-of-contents__link toc-highlight">Memory</a></li></ul></li><li><a href="#remote-access-to-the-database" class="table-of-contents__link toc-highlight">Remote access to the database</a></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a><ul><li><a href="#server-error-500-when-starting-a-campaign" class="table-of-contents__link toc-highlight">Server error 500 when starting a campaign</a></li><li><a href="#impossible-to-get-results-from-explorer-place" class="table-of-contents__link toc-highlight">Impossible to get results from Explorer place</a></li></ul></li><li><a href="#lets-quickly-wrap-up-here" class="table-of-contents__link toc-highlight">Let&#39;s quickly wrap up, here</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">© 2025 UXO Docs</div></div></div></footer></div>
</body>
</html>